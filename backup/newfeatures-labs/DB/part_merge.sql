set echo on
CREATE OR REPLACE DIRECTORY dp_dir AS '/home/oracle/labs/DB';
GRANT read, write ON DIRECTORY dp_dir TO sh;

DROP TABLE sh.sales CASCADE CONSTRAINTS PURGE;
CREATE TABLE SH.SALES
       (PROD_ID NUMBER, CUST_ID NUMBER, TIME_ID DATE,
        CHANNEL_ID NUMBER, PROMO_ID NUMBER, 
        QUANTITY_SOLD NUMBER(10,2), AMOUNT_SOLD NUMBER(10,2))
     PARTITION BY RANGE (TIME_ID)
    (PARTITION SALES_1995 VALUES LESS THAN (TO_DATE('1996-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_1996 VALUES LESS THAN (TO_DATE('1997-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_H1_1997 VALUES LESS THAN (TO_DATE('1997-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_H2_1997 VALUES LESS THAN (TO_DATE('1998-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_1998 VALUES LESS THAN (TO_DATE('1998-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_1998 VALUES LESS THAN (TO_DATE('1998-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_1998 VALUES LESS THAN (TO_DATE('1998-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_1998 VALUES LESS THAN (TO_DATE('1999-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_1999 VALUES LESS THAN (TO_DATE('1999-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_1999 VALUES LESS THAN (TO_DATE('1999-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_1999 VALUES LESS THAN (TO_DATE('1999-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_1999 VALUES LESS THAN (TO_DATE('2000-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_2000 VALUES LESS THAN (TO_DATE('2000-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_2000 VALUES LESS THAN (TO_DATE('2000-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_2000 VALUES LESS THAN (TO_DATE('2000-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_2000 VALUES LESS THAN (TO_DATE('2001-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_2001 VALUES LESS THAN (TO_DATE('2001-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_2001 VALUES LESS THAN (TO_DATE('2001-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_2001 VALUES LESS THAN (TO_DATE('2001-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_2001 VALUES LESS THAN (TO_DATE('2002-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_2002 VALUES LESS THAN (TO_DATE('2002-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_2002 VALUES LESS THAN (TO_DATE('2002-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_2002 VALUES LESS THAN (TO_DATE('2002-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_2002 VALUES LESS THAN (TO_DATE('2003-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q1_2003 VALUES LESS THAN (TO_DATE('2003-04-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q2_2003 VALUES LESS THAN (TO_DATE('2003-07-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q3_2003 VALUES LESS THAN (TO_DATE('2003-10-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')),
     PARTITION SALES_Q4_2003 VALUES LESS THAN (TO_DATE('2004-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')));

exit
